<% categories.each do |cate| %>
  <% child_category = children_categories(cate.id) %>
  <% if child_category.count > 0 %>
  <li class="dropdown-submenu mydrop">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= cate.name %> </a>
    <% if child_category.any? %>
      <% child_category.each do |child| %>
        <% categories.delete(child) %>
      <% end %>
    <ul class="dropdown-menu">
      <%= render partial: "layouts/subcategory", locals: {categories: child_category.to_a} %>
    </ul>
    <% end %>   
  </li>
  <% else %>
    <li><a href="#"><%= cate.name %></a></li>
  <% end %>
<% end %>
